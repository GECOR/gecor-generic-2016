<ion-navbar *navbar hideBackButton class="show-navbar android-attr">

  <div showWhen="android">
    <ion-title pull-left>
      {{"incidents.title" | translate}}
      <div toolbar-subtitle>
        {{user.AyuntamientoNombre}}
      </div>
    </ion-title>
    <ion-buttons end pull-right>
        <button (click)="type='list'" [hidden]="type=='list'" outline><ion-icon name="list-box"></ion-icon></button>
        <button (click)="type='list'" [hidden]="type!='list'" class="activated" outline><ion-icon name="list-box"></ion-icon></button>
        <button (click)="showMap();type='map'" [hidden]="type=='map'" outline><ion-icon name="map"></ion-icon></button>
        <button (click)="showMap();type='map'" [hidden]="type!='map'" class="activated" outline><ion-icon name="map"></ion-icon></button>
        <button (click)="type='gallery'" [hidden]="type=='gallery'" outline><ion-icon name="images"></ion-icon></button>
        <button (click)="type='gallery'" [hidden]="type!='gallery'" class="activated" outline><ion-icon name="images"></ion-icon></button>
    </ion-buttons>
  </div>

  <div showWhen="ios">
    <ion-title>
      {{"incidents.title" | translate}}
      <div toolbar-subtitle>
        {{user.AyuntamientoNombre}}
      </div>
    </ion-title>
    <ion-buttons end >
        <button (click)="type='list'" [hidden]="type=='list'" ><ion-icon name="list-box"></ion-icon></button>
        <button (click)="type='list'" [hidden]="type!='list'" class="activated" ><ion-icon name="list-box"></ion-icon></button>
        <button (click)="showMap();type='map'" [hidden]="type=='map'" ><ion-icon name="map"></ion-icon></button>
        <button (click)="showMap();type='map'" [hidden]="type!='map'" class="activated" ><ion-icon name="map"></ion-icon></button>
        <button (click)="type='gallery'" [hidden]="type=='gallery'" ><ion-icon name="images"></ion-icon></button>
        <button (click)="type='gallery'" [hidden]="type!='gallery'" class="activated"><ion-icon name="images"></ion-icon></button>
    </ion-buttons>
  </div>

</ion-navbar>


<ion-content class="incidents-page">

  <ion-searchbar [hidden]="type=='map'"
    [(ngModel)]="searchText"
    (input)="inputSearch($event)">
  </ion-searchbar>

  <div padding [hidden]="type == 'map'">
    <ion-segment [(ngModel)]="order">
      <ion-segment-button value="FechaHoraRegistro">Date</ion-segment-button>
      <ion-segment-button value="Distancia">Distance</ion-segment-button>
    </ion-segment>
  </div>
  
  

  <div id="switch" [ngSwitch]="type">
    <ion-list *ngSwitchDefault>
      <ion-item-sliding *ngFor="let incident of incidents | arraySort:order:'desc' | search: searchText" [ngClass]="classIncident(incident)" #slidingItem>
        <!--<div [ngSwitch]=incident.state>
          <p danger *ngSwitchWhen="'Pendiente'">{{incident.Estado}}</p>
          <p secondary *ngSwitchWhen="'Terminada'">{{incident.Estado}}</p>
        </div>-->
        <!--<button clear item-right (click)="openDetail(incident)">View</button>-->
        <button ion-item (click)="openDetail(incident)">
          <ion-thumbnail item-left>
          <img src="{{incident.RutaFoto != '' ? incident.RutaFoto : 'img/no_image_512.png'}}" incident-img>
          </ion-thumbnail>
          <h2>{{incident.DesTipoElemento}}</h2>
          <p>{{incident.DesUbicacion}}</p>
          <p>{{incident.Responsable}}</p>
          <p>{{incident.CodAviso}}</p>
        </button>
        <ion-item-options>
          <button (click)="openReview(incident, slidingItem)"><ion-icon name="checkmark-circle"></ion-icon>Review</button>
        </ion-item-options>
      </ion-item-sliding>
    </ion-list>

    <div id="mapContainer" *ngSwitchWhen="'map'">
      <div id="mapDetail"></div>      
    </div>

    <div id="gallery" *ngSwitchWhen="'gallery'">
      <ion-card *ngFor='let incident of incidents | arraySort: order | search: searchText'>
        <img src={{incident.RutaFoto}}/>
        <ion-card-content>
          <!--<div [ngSwitch]=incident.state>
            <h2 secondary class="card-title" *ngSwitchWhen="'Terminada'">
              {{incident.Estado}}
            </h2>
            <h2 danger class="card-title" *ngSwitchWhen="'Pendiente'">
              {{incident.Estado}}
            </h2>
          </div>-->
          <p>
            {{incident.DesUbicacion}}
          </p>
          <button clear item-right class="pull-right" (click)="openDetail(incident)">View</button>
        </ion-card-content>
      </ion-card>
    </div>

  </div>



</ion-content>
